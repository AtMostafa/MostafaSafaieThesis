\section{Implementation}
\label{ch:intro:implementation}
% why basal ganglia
% (maybe first the anatomy)
The renowned neuroscientist, David Marr (1945--1980), proposed three levels of analysis to understand a complex system.
First, the \emph{computational level}, describes the task and the goal that need be achieved.
Second, the \emph{algorithmic level}, specifies the procedures for manipulating the information associated with the computation.
Third, the \emph{implementation level}, characterizes how the to physically realize the algorithm~\cite{Willshaw2015Marr}.
\Citeauthor{Krakauer2017Neuron} in a perspective article that greatly influenced this work, present the following example~\cite{Krakauer2017Neuron}.
Understanding a flying bird could be achieved at three levels:
A bird attempts to \textit{fly} (level~1:~computation) by \textit{flapping} its wings (level~2:~algorithm) which is plausible due to aerodynamic properties of the \textit{feathers} (level~3:~implementation).
They then argue that the explanatory power of studying feathers alone is fundamentally restricted, evident by some birds that fly without feathers and some types of flight that does not require flapping.
As it pertains to the link between brain and behavior, it may be much more difficult to infer the algorithms used by brain from studying the nervous system, compared to understanding them at a computational level.
\par
Thus far, I portrayed the case for behavioral importance of time estimation (level~1), and different possible strategies to estimate an interval (dedicated, emergent, and embodied clock, level~2).
In this section, I will address how those strategies could be implemented in the brain (level~3).
Of all the brain regions that have been suggested to be involved in time perception\footnotemark, across a wide range of tasks and scales, \gls{bg} is of unique interest.
\footnotetext{
    So many brain structures have been found implicated in time estimation that prompted \citeauthor{Wittmann2013NatRevNeurosci} to state: ``one may be inclined to state that researchers are actually clueless concerning the question of how the brain processes time."~\cite{Wittmann2013NatRevNeurosci}.
    }
For decades, \gls{bg} have been the focus of many timing studies~\cite[see][]{Paton2018NeuronRev}, as well as motor studies~\cite[see][]{Turner2010CurrOpinNeurobiol}.
Therefore, it could be considered as an ideal candidate structure to mediate timing behavior through sensorimotor mechanisms.

\subsection{Anatomy of the Basal Ganglia}
\label{intro:BGAnatomy}
The \gls{bg} are a set of interconnected subcortical nuclei.
Their neural organization is highly preserved in vertebrates for over 500 million years~\cite{Grillner2016BG}.
The \gls{bg} may be viewed as a two-input two-output system.
The striatum and the \gls{stn} are the input structures receiving excitatory afferents from virtually the entire cerebral cortex and thalamus.
The output nuclei are the internal segment of the globus pallidus, also called \gls{gpi}, and the \gls{snr}.
The output structures receive inhibitory input from the striatum and excitatory input from the \gls{stn}.
They both contain tonically-active GABAergic neurons that target motor centers in the brainstem and thalamus.
There are no direct connections from the \gls{bg} outputs to motor neurons of the brainstem or spinal cord~\cite{Mink1996}.
\par
Other than the input and output nuclei, the \gls{bg} also include \emph{intrinsic} structures:
The external segment of the globus pallidus, called \gls{gpe}, is also innervated by the striatum as well as the \gls{stn} and projects back to the \gls{stn} and the output nuclei.
\Gls{snc} is the center of \gls{da}-containing neurons in the \gls{bg} and targets the striatal neurons.
\autoref{fig:intro:BGAnatomy} summarizes the anatomy of the \gls{bg}.

\input{ch-intro/figures/BGAnatomy.tex}
\subsection{Striatum} \label{intro:anatomy:striatum}
%order of material: MSNs > interneurons > I/O > D/ID pathway > dopamine > topography > DLS/DMS
The striatum is the main input nucleus of the \gls{bg} and one of the largest undivided structures in rodent brain atlas.
Despite several cell types, GABAergic \glspl{msn} constitute~90--95\% of its neural population.
Their name stems from their size and the abundance of their dendritic processes~\cite{TURNER2000BasalFunction}.
They are mostly quiescent, except during  motor activity or in response to sensory stimuli~\cite{KandelBook2001}.
\par
The striatum also contains two major types of inhibitory interneurons.
\Glspl{fsi} target \glspl{msn} at the soma level by gap junctions and provide powerful GABAergic synapses to several hundreds of surrounding \glspl{msn}~\cite{Grillner2016BG, Gage2010FSI}.
Although they are scarce, \glspl{fsi} have higher firing rate compared to \glspl{msn} and are capable of delaying action potentials in the neighboring \glspl{msn}~\cite{Wilson2007GABAergicNeostriatum}.
Large cholinergic interneurons are the other type of striatal interneurons.
They have tonic discharge patterns, and in primate, are referred to as \textit{tonically active neurons}.
\Glspl{fsi} and cholinergic interneurons each comprise approximately~1\% of striatal neurons in rodents, nonetheless, they are believed to strongly contribute to the dominance of inhibition in the striatum~\cite{Gage2010FSI}.
In addition to these two, several other types of GABAergic interneurons within the striatum are described as well~\cite{Grillner2016BG}.
\par
Massive excitatory projections from all areas of cortex target striatal \glspl{fsi} as well as \glspl{msn}.
Intralaminar nuclei of the thalamus also provide excitatory input (\autoref{fig:intro:BGAnatomy}).
Altogether, these glutamatergic synapses make up 80\% of all synapses in the striatum~\cite{Wilson2007GABAergicNeostriatum}.
Moreover, \gls{da}ergic afferents from the \gls{snc} are the main source of neuromodulatory influence.
They primarily synapse with principle neurons (\glspl{msn}).
\Gls{da} release modulates \gls{msn} activity differentially.
\par
\Glsentrylongpl{msn} are the only way out of the striatum.
They project to the globus pallidus and substantia nigra.
Based on their neurochemistry and projection patterns, they are divided into two distinct types.
One class expresses \glspl{d1} and projects directly to \gls{gpi}/\gls{snr} neurons, hence they form the so-called~\emph{direct pathway}.
The second kind expresses \glspl{d2} and projects to \gls{gpe}.
This path, in turn, leads to the output nuclei through two routes:~monosynaptic~\gls{gpe}$\rightarrow$output, or bisynaptic~\gls{gpe}$\rightarrow$\gls{stn}$\rightarrow$output projections~\cite{TURNER2000BasalFunction}.
These \glspl{msn} form the \emph{indirect pathway} (\autoref{fig:intro:BGAnatomy}).
Of note, \gls{stn} efferents form the only intrinsic excitatory connections in the basal ganglia, an otherwise inhibition-dominated structure.
\par
\Gls{da} significantly modulates neuronal activity in the striatum.
Axons from \gls{snc} neurons arborize widely in the striatum.
They mainly target the narrow necks connecting the spines to dendritic shafts, whereas cortical inputs mostly terminate on dendritic shafts.
This particular arrangement may be a mechanism by which \gls{da} release modulates cortical input to the \glspl{msn}~\cite{TURNER2000BasalFunction}.


\subsection{Basal Ganglia as a Clock}
\label{ch:intro:BGTime}

Many brain structures have been proposed to contribute to time estimation.
The \gls{bg}, a set of interconnected subcortical nuclei, are especially of interest, since they are directly involved in motor processes as well~\cite{Grillner2015}.
Moreover, the \gls{bg} are also involved in reinforcement learning---selecting actions in an uncertain world in a way that maximizes reward in the long term~\cite{Petter2018}.
Such learning necessitates an understanding of temporal contingencies in order to maximize some future reward.
Behavioral data also supports that animals build probabilistic models for timing~\cite{li2013PNAS}.
In general, execution of any complex behavior requires proper timing of the comprising sub-actions.
\par
The \gls{bg} are often implicated in timescales of several hundreds of milliseconds to several seconds~\cite{Paton2018NeuronRev}.
Evidence of involvement of the \gls{bg} in timing stems from a variety of sources, including pathologies such as \gls{pd}, lesion studies, and pharmacological and genetic manipulations.
\par
Following the taxonomy discussed in \autoref{ch:intro:taxonomy}, there is some evidence of involvement of the \gls{bg} in sensory timing.
\Citeauthor*{Rao2001} reported encoding of time intervals in the human striatum in a task in which subjects reported whether an interval were shorter or longer than a standard interval of 1200~ms.\footnotemark\
They also observed a dynamic network of cortical activity in inferior parietal, premotor, and dorsolateral prefrontal cortex.
These nodes in the network were attributed to different components of temporal processing, respectively, attention, memory, and interval comparison.
They collectively concluded implication of the ``striatal dopaminergic neurotransmission in hypothetical internal timekeeping mechanisms"~\cite{Rao2001}.
\footnotetext{
    This paradigm is commonly referred to as ``interval categorization task".
    }
\Citeauthor*{Pouthas2005} also investigated interval categorization for two durations (450~ms and 1300~ms).
They observed ramping striatal activity during both intervals.
They concluded a direct role of the basal ganglia in duration estimation, and that the caudate nucleus ``may support a clock mechanism"~\cite{Pouthas2005}.
Similar evidence exist in other species too.
\Citeauthor*{Gouvea2015Elife} trained rats in a sensory categorization task to judge whether an interval is shorter or longer than 1.5~s.
They decoded animals' choice and elapsed time from ensembles of striatal neuronal activity, whereas apparent behavior in an overhead video failed to do so.
Transient inactivation of the \gls{ds} impairs performance, however, it doesn't cause a systematic under-- or over--estimation~\cite{Gouvea2015Elife}.
\par
% Furthermore, the \gls{bg} are also well studied for their role in motor timing.
% In a range of disorders affecting the \gls{bg}, including \gls{pd}, Huntington's disease, Tourette's syndrome, drug abuse, and attention deficit disorder, an altered perception of time, or temporal patterns have been reported~\cite[see][]{Paton2018NeuronRev}.
Furthermore, the \gls{bg} are also well studied for their role in motor timing.
\Citeauthor*{Matell2003} trained rats to receive a reward in a fixed interval reinforcement schedule.\footnotemark\
The interval alternated between 10~s (25\% of trials) and 40~s (75\% of trials).
After learning, animals increased their lever press rate around the reinforced intervals.
Electrophysiological recordings from the striatum show neurons with tuned firing rate only around 10~s interval, but not 40~s, while apparent behavior of the animals is similar.
The authors then suggest that a population of duration-coding cells, each tune to different values, could accurately represent the elapsed time~\cite{Matell2003}.
\footnotetext{
    In operant conditioning, fixed interval reinforcement schedule refers to a type of conditioning whereby a response is reinforced (i.e., rewarded) only if a certain period of time (i.e., interval) has elapsed.
    }
\Citeauthor*{Mello2015} also used a similar task for intervals ranging between 12~s to 60~s.
They found striatal cells that rescaled their activity when intervals changed.
As rats adjusted to the new interval, time estimations decoded form population dynamics predicted animals' timing performance.
In another study, \Citeauthor*{Bakhurin2017JNeuro} used a conditioning paradigm to signal delayed reward delivery (2.5~s after cue onset).
Individual neurons recorded in the striatum and orbitofrontal cortex display sequential activity during the interval.
A machine learning algorithm was then trained to decode the elapsed time from the stimulus onset.
They show that both striatal and cortical networks ``encoded time, but the striatal network outperformed the orbitofrontal cortex".
Interestingly, removing the neurons modulated by licking activity from the decoder significantly reduced its performance, however, it still remained higher than chance level~\cite{Bakhurin2017JNeuro}.
\par
Another source of impact in the \glsentrylong{bg} is the neuromodulatory effect of \gls{da}.
\Glsentrylong{da}'s role in reward processing and circuit dynamics of the striatum will be discussed later in sections~\ref{intro:BGMotor} and \ref{intro:BGAnatomy}.
However, \gls{da} is also believed to be involved in timing~\cite{Paton2018NeuronRev}.
In a peak interval procedure\footnotemark, \Citeauthor*{DeCorte2019} found that \gls{d2} blockade delayed start and stop times for an interval of 6~s.
Whereas, blockade of \glspl{d1} delayed stop times.
Then they stress the role of the \gls{ds} in timing, with \gls{da} ``being particularly critical for the temporal control of action"~\cite{DeCorte2019}.
\footnotetext{
    Peak interval procedure is a common task used to study timing.
    Similar to fixed interval schedules, a cue indicates that a response will be reinforced only after a certain period of time has elapsed.
    The profile of the response around the interval is then studied.
    }
\Glsentrylong{da} neurons encode reward prediction errors which requires accurate reward predictions~\cite[see][]{Berke2018NN}.
\Citeauthor*{Takahashi2016} recorded from \gls{da} neurons of rats while they performed a task with uncertainty in reward timing and reward number.
Neuronal activity showed error signals in response to both types of prediction error, however, after ventral striatal lesions, neurons only responded to changes in reward number, and not reward timing.
These results suggest that time-dependant component of reward prediction of \gls{da} neurons might rely on the ventral striatum~\cite{Takahashi2016}.
In an interesting study, \Citeauthor*{Paton2016Sci} measured and manipulated the activity of \gls{da} neurons in a 1.5~s interval categorization task.
\Gls{da}ergic activity predicted animal's time estimates.
Transient activation/inhibition of \gls{da} neurons caused under-/over-estimation of the interval.
Hence, they concluded that ``\gls{da} neurons, which are so central to reward processing, exert control over time estimation"~\cite{Paton2016Sci}, although these results reflect \gls{da} function in general, not specifically in the \gls{bg}.
Similar to scaling of neuronal activity in the striatum~\cite{Mello2015}, \gls{da} concentration in the \gls{ds} is also scalable to time intervals in several second time range~\cite{Howard2017}.
However, \citeauthor{Howard2017} then conducted a series of experiments and concluded that the \gls{da} signal in the \gls{ds} does not reflect interval timing \textit{per se}, rather it is specific to behavioral choice of action~\cite{Howard2017}.




\subsection{Basal Ganglia as a Sensorimotor System}
\label{intro:BGMotor}
\epigraph{Why do we and other animals have brains?\ldots You may reason that we have one to perceive the world or to think, and that is completely wrong\ldots We have a brain for one reason and one reason only, and that is to produce adaptable and complex movements.}
{\textit{Daniel Wolpert, TED talk}}
\noindent

Here, I am supposed to review the literature on the function of the \gls{bg}.

\subsubsection{Motor Control} \label{intro:motorControl}
\subsubsection{Motor Learning} \label{intro:motorLearning}
% \subsubsection{DLS}
% \subsubsection{DMS}
\subsubsection{Action Selection} \label{intro:actionSelection}
\subsubsection{Motor Habits} \label{intro:motorHabits}
\subsubsection{Cognition} \label{intro:bgCognition}

\subsection{Pathologies}
\label{intro:Motor:pathologies}
